# Diffusion Policy Rollout Configuration

defaults:
  - env: env

# Device
device: cuda:0

# Checkpoint
ckpt_path: ./checkpoints/diffusion_policy.pth
statistics_path: ./dataset/statistics.yaml

# Model architecture (must match training config)
action_dim: 6
pred_horizon: 30
img_token_dim: 192
state_token_dim: 12
img_cond_len: 196
img_pos_embed_config: null
model_name: vit_tiny_patch16_224
use_bf16: false

dp_config:
  depth: 8
  num_heads: 8
  hidden_size: 512
  img_adaptor: mlp2x_gelu
  state_adaptor: mlp3x_gelu
  action_adaptor: mlp3x_gelu
  noise_scheduler:
    type: ddpm
    num_train_timesteps: 1000
    num_inference_timesteps: 5
    beta_schedule: squaredcos_cap_v2
    prediction_type: sample
    clip_sample: false

# Image processing
image_resize: 256
image_size: 224

# Normalization
proprio_norm_type: max_min
action_norm_type: max_min

# Action horizon: how many steps to use from each prediction
action_horizon_steps: 8

# Rollout settings
num_episodes: 10
max_steps: 1000

# Data saving
save_data: false
save_path: ./rollout_data/diffusion
